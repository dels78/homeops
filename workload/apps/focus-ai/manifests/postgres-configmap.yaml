apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-init
  namespace: focus-ai
  labels:
    app.kubernetes.io/name: focus-ai
    app.kubernetes.io/component: database
data:
  init.sql: |
    -- Create database if it doesn't exist
    SELECT 'CREATE DATABASE focus_ai' WHERE NOT EXISTS (SELECT FROM pg_database WHERE datname = 'focus_ai')\gexec

    -- Connect to focus_ai database
    \c focus_ai

    -- Grant permissions to focus_ai_user
    GRANT ALL PRIVILEGES ON DATABASE focus_ai TO focus_ai_user;
    GRANT ALL ON SCHEMA public TO focus_ai_user;
